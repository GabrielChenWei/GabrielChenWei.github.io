<html>
<head>
  <title>SOAP JavaScript Client Test</title>
  <script type="text/javascript">
  function soap() {
    var xmlhttp = new XMLHttpRequest();
    var url = "https://emea.amplight.philips.com/AmplightAPI/AmplightWebService";
    var proxyurl = "https://cors-anywhere.herokuapp.com/";
    var bypassurl = proxyurl + proxyurl;
    xmlhttp.open("POST", bypassurl, true, "gabriellac", "123456789");
     // build SOAP request
     var sr =
       '<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"' +
       'xmlns:v2="http://schemas.amplightapi.amplight.lighting.philips.com/ControlSystem/v2.0">' +
       '<soapenv:Header/>' +
         '<soapenv:Body>' +
		   '<v2:BoxInfo>' +
		     '<v2:userinfo>' +
               '<v2:userid>gabriellac</v2:userid>' +
               '<v2:password>123456789</v2:password>' +
             '</v2:userinfo>' +
             '<v2:nodeid>3049210</v2:nodeid>' +
           '</v2:BoxInfo>' +
         '</soapenv:Body>' +
       '</soapenv:Envelope>';
        
      //specify request headers
      xmlhttp.setRequestHeader('Content-Type', 'text/xml; charset=utf-8');
      xmlhttp.setRequestHeader('Authorization','Basic ' + btoa("gabriellac"+":"+"123456789"));
      
       xmlhttp.onreadystatechange = function () {
        //if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            var response = xmlhttp.responseText;
	    document.getElementById("demoP").innerHTML = response;
	    console.log("I am working: " + response);
	    alert('done. use firebug/console to see network response');
        //}
      }
      
      //xmlhttp.setRequestHeader('Content-Type', 'text/xml');
      xmlhttp.send(sr);
      console.log("I have sent: " + sr);
      // send request
      // ...
    }
  </script>
</head>
<body>
  <form name="Demo" action="" method="post">
    <div>
      <input type="button" value="Soap" onclick="soap();" />
    </div>
  </form>
	<p id="demoP"></p>
</body>
</html> <!-- typo -->
